# 웹캠을 이용한 라인트레이싱 기능 구현 코드
---
usb 카메라를 통해 실시간으로 종이에 그려진 검정색 선을 인식하고 이를 기반으로 선 중심을 추적하여 향후 라인트레이서 로봇 등에 적용하기 위한 실습코드.
---
- 사용 기술
    - python 3
    - opencv(cv2)
    - Matplotlib(실시간 히스토그램 디버깅용)
    - numpy
---
- 진행단계 요약
    1. usb카메라 연결 및 실시간 영상 출력
        ```
        cv2.VideoCapture(1)
        ret, img = cap.read()
        cv2.imshow('camera', img)
        ```
    
    2. BGR -> GRAY 변환 + 전체 히스토그램 출력
        cv2.cvtColor()로 GRAY 영상 생성
        cv2.calcHist() + matplotlib을 이용해 픽셀값 분포 시각화
        밝기 분포 확인 및 선/배경 분석 기반 마련
    
    3. ROI(관심영역) 설정 및 좌우 분할 비교
        영상 중앙 또는 특정 구간을 gray[y1:y2, :]로 잘라 ROI 설정
        ROI를 좌/우로 나누고 각각의 히스토그램 비교
        검정선 존재 여부를 픽셀값 < 50 빈도로 판단
    
    4. 선 중심 추출: 픽셀 가중 평균(center of mass) 방식
        ROI 이진화 후, 각 열의 검정 픽셀 수 계산
        np.sum(x * weight) / np.sum(weight) 공식으로 중심 계산 -> 단순한 계산식의 의한 중심점 추출
        cv2.circle()로 중심 위치 시각화

    5. 선 중심 추출: cv2.findContours() + cv2.moments() 방식
        컨투어 방식을 사용하여 윤곽선 추출 및 중심선 계산 방식으로 수정함.
        ROI 이진화 후 윤곽선 추출 (cv2.findContours)
        가장 큰 윤곽선에 대해 cv2.moments()로 무게중심 계산
        중심좌표를 원본 이미지에 표시
        선 꺾임, 흔들림 대응을 위해 ROI를 더 넓게 설정

    6. 인식률 향상 방법 적용
        이진화 임계값 증가: 흐릿한 선도 인식 가능하도록 threshold 값 조정 (50 → 80)

    7. 윤곽선 시각화
        cv2.drawContours()로 ROI 내 윤곽선을 초록색으로 시각화
        ROI 내부 좌표를 전체 영상 좌표에 맞게 y좌표 보정 (cnt + [0, roi_top])
---
- 결과
    - 실시간으로 검정 선 인식 성공
    - 흐리거나 굽은 선에도 안정적인 중심 추적 가능
    - 이후 라인트레이서로 확장 가능한 기반 확보

